Before:
  call ale#assert#SetUpLinterTest('erlang', 'erlang_ls')

After:
  unlet! b:root
  call ale#test#RemoveCreatedDirectories()
  call ale#assert#TearDownLinterTest()

Execute(The default command should be correct):
  AssertLinter 'erlang_ls',
  \ ale#Escape('erlang_ls') . ' --log-level=' . ale#Escape('info')

Execute(Executable should be configurable):
  let b:ale_erlang_erlang_ls_executable = '/path/to/erlang_ls'

  AssertLinter '/path/to/erlang_ls',
  \ ale#Escape('/path/to/erlang_ls') . ' --log-level=' . ale#Escape('info')

Execute(Log level should be configurable):
  let b:ale_erlang_erlang_ls_log_level = 'debug'

  AssertLinter 'erlang_ls',
  \ ale#Escape('erlang_ls') . ' --log-level=' . ale#Escape('debug')

Execute(Log directory should be configurable):
  let b:ale_erlang_erlang_ls_log_dir = '/path/to/logs'

  AssertLinter 'erlang_ls',
  \ ale#Escape('erlang_ls')
  \ . ' --log-dir=' . ale#Escape('/path/to/logs')
  \ . ' --log-level=' . ale#Escape('info')

Execute(Project root should be detected using erlang_ls.config):
  let b:root = ale#test#CreateDirectoryWith([
  \ 'erlang_ls.config',
  \])

  call ale#test#SetFilename(b:root . '/src/app.erl')
  AssertLSPProject b:root

  let b:root = ale#test#CreateDirectoryWith([
  \ '_build/default/lib/dep/erlang_ls.config',
  \ 'erlang_ls.config',
  \])

  call ale#test#SetFilename(b:root . '/_build/default/lib/dep/src/dep.erl')
  AssertLSPProject b:root

  let b:root = ale#test#CreateDirectoryWith([
  \ 'deps/dep/erlang_ls.config',
  \ 'erlang_ls.config',
  \])

  call ale#test#SetFilename(b:root . '/deps/dep/src/dep.erl')
  AssertLSPProject b:root

Execute(Root of Rebar3 project should be detected):
  let b:root = ale#test#CreateDirectoryWith([
  \ 'rebar.lock',
  \])

  call ale#test#SetFilename(b:root . '/src/app.erl')
  AssertLSPProject b:root

  let b:root = ale#test#CreateDirectoryWith([
  \ '_build/default/lib/dep/rebar.lock',
  \ 'rebar.lock',
  \])

  call ale#test#SetFilename(b:root . '/_build/default/lib/dep/src/dep.erl')
  AssertLSPProject b:root

  let b:root = ale#test#CreateDirectoryWith([
  \ '_checkouts/dep/_build/',
  \ '_build/',
  \])

  call ale#test#SetFilename(b:root . '/_checkouts/dep/src/dep.erl')
  AssertLSPProject b:root

Execute(Root of Erlang.mk project should be detected):
  let b:root = ale#test#CreateDirectoryWith([
  \ 'erlang.mk',
  \])

  call ale#test#SetFilename(b:root . '/src/app.erl')
  AssertLSPProject b:root

  let b:root = ale#test#CreateDirectoryWith([
  \ 'deps/dep/erlang.mk',
  \ 'erlang.mk',
  \])

  call ale#test#SetFilename(b:root . '/deps/dep/src/dep.erl')
  AssertLSPProject ale#test#GetFilename(b:root)

Execute(Root of kerl managed Erlang/OTP installation should be detected):
  let b:root = ale#test#CreateDirectoryWith([
  \ '.kerl_config',
  \])

  call ale#test#SetFilename(b:root . '/lib/stdlib-4.1.1/array.erl')
  AssertLSPProject b:root
